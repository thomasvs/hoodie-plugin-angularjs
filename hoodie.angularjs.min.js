angular.module("hoodie",[]),angular.module("hoodie").factory("hoodieAccount",["$rootScope","hoodie","$q",function(n,e,o){var t={};return angular.forEach(e.account,function(n,a){t[a]=angular.isFunction(n)?function(){return o.when(e.account[a].apply(e.account,arguments))}:e.account[a]}),angular.forEach(["signup","signin","signout","authenticated","unauthenticated"],function(o){e.account.on(o,function(e){n.$apply(function(){t.username=e}),n.$emit("hoodie:"+o,arguments)})}),t.username=e.account.username,t}]),angular.module("hoodie").factory("hoodieArray",["hoodieStore",function(n){function e(n,e){for(var o={},t=0;t<n.length;t++)o[n[t][e]]=n[t];return o}function o(n,o,t){var a,i={added:[],deleted:[],changed:[]},r=e(n,"id"),u=e(o,"id");for(a in r)u.hasOwnProperty(a)?t(u[a],r[a])||i.changed.push(u[a]):i.deleted.push(r[a]);for(var d in o)o[d].id||i.added.push(o[d]);return i}var t={};return t.bind=function(e,t,a){a=a||t,e[t]=e[t]||[],n.findAll(a).then(function(n){e[t]=n}),e.$watch(t,function(e,t){if(e!==t&&angular.isArray(e)&&angular.isArray(t)){var i,r,u=o(t,e,angular.equals);for(r in u.added)i=u.added[r],n.add(a,i);for(r in u.changed)i=u.changed[r],n.update(a,i.id,i);for(r in u.deleted)i=u.deleted[r],i.id&&n.remove(a,i.id)}else;},!0),n.on("change:"+a,function(){n.findAll(a).then(function(n){e[t]=n})})},{bind:t.bind}}]),angular.module("hoodie").factory("hoodieObject",["hoodieStore","$rootScope",function(n,e){function o(n,e){return angular.forEach(n,function(o,t){e.hasOwnProperty(t)||delete n[t]}),angular.extend(n,e),n}var t={};return t.bind=function(t,a){if(angular.isUndefined(t))throw new Error("[hoodie-angular-plugin(HoodieObjects.bind)]: A store must be given");var i,r={};return i=angular.isUndefined(a)?n.add(t,r).then(function(n){a=n.id,o(r,n)}):n.find(t,a).then(function(n){angular.extend(r,n)}),e.$watch(function(){return r},function(e){n.update(t,a,e)},!0),i.then(function(){e.$on("change:"+a+":"+t,function(n,e){o(r,e)})}),r},{bind:t.bind}}]),angular.module("hoodie").provider("hoodie",function(){var n;this.url=function(e){return arguments.length&&(n=e),e},this.$get=["$location",function(e){return n||(n=e.absUrl().replace("/#"+e.path(),"")),window.hoodie=new Hoodie(n)}]}),angular.module("hoodie").factory("hoodieStore",["$rootScope","$q","hoodie",function(n,e,o){var t={};return angular.forEach(o.store,function(n,a){t[a]=angular.isFunction(n)?function(){return e.when(o.store[a].apply(o.store,arguments))}:o.store[a]}),t.findAll().then(function(n){n.forEach(function(n){var e=n.type;t[e]=t[e]||[],t[e].push(n)})}),o.store.on("change",function(e,o){n.$evalAsync(function(){var a=o.type,i=o.id;n.$emit(e,o),n.$emit("change",e,o),n.$emit(e+":"+a,o),n.$emit("change:"+a,e,o),n.$emit(e+":"+a+":"+i,o),n.$emit("change:"+a+":"+i,e,o),t.findAll(a).then(function(n){t[a]=n})})}),t}]);